{"ast":null,"code":"var _jsxFileName = \"/Users/yutianjian/test/oda/src/viewer/ContextMenu/ContextMenu.js\";\n///////////////////////////////////////////////////////////////////////////////\n// Copyright (C) 2002-2021, Open Design Alliance (the \"Alliance\").\n// All rights reserved.\n//\n// This software and its documentation and related materials are owned by\n// the Alliance. The software may only be incorporated into application\n// programs owned by members of the Alliance, subject to a signed\n// Membership Agreement and Supplemental Software License Agreement with the\n// Alliance. The structure and organization of this software are the valuable\n// trade secrets of the Alliance and its suppliers. The software is also\n// protected by copyright law and international treaty provisions. Application\n// programs incorporating this software must include the following statement\n// with their copyright notices:\n//\n//   This application incorporates Open Design Alliance software pursuant to a\n//   license agreement with Open Design Alliance.\n//   Open Design Alliance Copyright (C) 2002-2021 by Open Design Alliance.\n//   All rights reserved.\n//\n// By use of this software, its documentation or related materials, you\n// acknowledge and accept the above terms.\n///////////////////////////////////////////////////////////////////////////////\nimport React, { Component } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class ContextMenu extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleClick = () => {\n      if (this.state.visible) {\n        this.setState({\n          visible: false\n        });\n      }\n    };\n\n    this.onContextMenu = event => {\n      event.preventDefault();\n\n      function clamp(val, min, max) {\n        return Math.min(Math.max(val, min), max);\n      }\n\n      const width = event.target.clientWidth;\n      const height = event.target.clientHeight;\n      let clickX = clamp(event.clientX, 0, width - 200);\n      let clickY = clamp(event.clientY, 0, height - 200);\n      this.setState({\n        visible: true,\n        x: clickX,\n        y: clickY\n      });\n    };\n\n    this.actionsList = [{\n      label: \"Unselect\",\n      icons: \"icons/unselected.svg\",\n      action: () => this.eventsConnection.onUnselect.next()\n    }, {\n      label: \"Isolate\",\n      icons: \"icons/isolate.svg\",\n      action: () => this.eventsConnection.onIsolateSelectedObjects.next()\n    }, {\n      label: \"Hide\",\n      icons: \"icons/hide.svg\",\n      action: () => this.eventsConnection.onHideSelectedObjects.next()\n    }, {\n      label: \"Show all\",\n      icons: \"icons/unisolate.svg\",\n      action: () => this.eventsConnection.onShowAll.next()\n    }, {\n      label: \"Explode\",\n      icons: \"icons/explode.svg\",\n      action: () => this.eventsConnection.onExplode.next()\n    }, {\n      label: \"Collect\",\n      icons: \"icons/collect.svg\",\n      action: () => this.eventsConnection.onCollect.next()\n    }, {\n      label: \"Regeneration\",\n      icons: \"icons/regen.svg\",\n      action: () => this.eventsConnection.onRegeneration.next()\n    }, {\n      label: \"Create preview\",\n      icons: \"icons/preview.svg\",\n      action: () => this.eventsConnection.onCreatePreview.next()\n    }];\n    this.state = {\n      visible: false,\n      x: 0,\n      y: 0\n    };\n    this.eventsConnection = props.eventsConnection;\n  }\n\n  componentDidMount() {\n    this.canvas = document.getElementById(\"canvas\");\n    this.canvas.addEventListener(\"click\", this.handleClick);\n    this.canvas.addEventListener(\"contextmenu\", this.onContextMenu);\n  }\n\n  componentWillUnmount() {\n    this.canvas.removeEventListener(\"click\", this.handleClick);\n    this.canvas.removeEventListener(\"contextmenu\", this.onContextMenu);\n  }\n\n  returnMenu(items) {\n    const myStyle = {\n      position: \"absolute\",\n      top: `${this.state.y}px`,\n      left: `${this.state.x + 5}px`,\n      zIndex: \"2000\"\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"context-menu\",\n      style: myStyle,\n      children: items.map(item => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"context-menu-item\",\n          onClick: () => {\n            item.action();\n            this.handleClick();\n          },\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"img\", {\n            src: item.icons,\n            alt: \"\",\n            width: \"30\",\n            height: \"30\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this), \" \", item.label]\n        }, item.label, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      onMouseEnter: this.mouseEnter,\n      onMouseLeave: this.mouseLeave,\n      children: this.state.visible ? this.returnMenu(this.actionsList) : null\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/yutianjian/test/oda/src/viewer/ContextMenu/ContextMenu.js"],"names":["React","Component","ContextMenu","constructor","props","handleClick","state","visible","setState","onContextMenu","event","preventDefault","clamp","val","min","max","Math","width","target","clientWidth","height","clientHeight","clickX","clientX","clickY","clientY","x","y","actionsList","label","icons","action","eventsConnection","onUnselect","next","onIsolateSelectedObjects","onHideSelectedObjects","onShowAll","onExplode","onCollect","onRegeneration","onCreatePreview","componentDidMount","canvas","document","getElementById","addEventListener","componentWillUnmount","removeEventListener","returnMenu","items","myStyle","position","top","left","zIndex","map","item","render","mouseEnter","mouseLeave"],"mappings":"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","sourcesContent":["///////////////////////////////////////////////////////////////////////////////\n// Copyright (C) 2002-2021, Open Design Alliance (the \"Alliance\").\n// All rights reserved.\n//\n// This software and its documentation and related materials are owned by\n// the Alliance. The software may only be incorporated into application\n// programs owned by members of the Alliance, subject to a signed\n// Membership Agreement and Supplemental Software License Agreement with the\n// Alliance. The structure and organization of this software are the valuable\n// trade secrets of the Alliance and its suppliers. The software is also\n// protected by copyright law and international treaty provisions. Application\n// programs incorporating this software must include the following statement\n// with their copyright notices:\n//\n//   This application incorporates Open Design Alliance software pursuant to a\n//   license agreement with Open Design Alliance.\n//   Open Design Alliance Copyright (C) 2002-2021 by Open Design Alliance.\n//   All rights reserved.\n//\n// By use of this software, its documentation or related materials, you\n// acknowledge and accept the above terms.\n///////////////////////////////////////////////////////////////////////////////\nimport React, { Component } from \"react\";\n\nexport class ContextMenu extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: false,\n      x: 0,\n      y: 0,\n    };\n    this.eventsConnection = props.eventsConnection;\n  }\n\n  handleClick = () => {\n    if (this.state.visible) {\n      this.setState({ visible: false });\n    }\n  };\n\n  onContextMenu = (event) => {\n    event.preventDefault();\n\n    function clamp(val, min, max) {\n      return Math.min(Math.max(val, min), max);\n    }\n\n    const width = event.target.clientWidth;\n    const height = event.target.clientHeight;\n\n    let clickX = clamp(event.clientX, 0, width - 200);\n    let clickY = clamp(event.clientY, 0, height - 200);\n\n    this.setState({ visible: true, x: clickX, y: clickY });\n  };\n\n  componentDidMount() {\n    this.canvas = document.getElementById(\"canvas\");\n    this.canvas.addEventListener(\"click\", this.handleClick);\n    this.canvas.addEventListener(\"contextmenu\", this.onContextMenu);\n  }\n\n  componentWillUnmount() {\n    this.canvas.removeEventListener(\"click\", this.handleClick);\n    this.canvas.removeEventListener(\"contextmenu\", this.onContextMenu);\n  }\n\n  returnMenu(items) {\n    const myStyle = {\n      position: \"absolute\",\n      top: `${this.state.y}px`,\n      left: `${this.state.x + 5}px`,\n      zIndex: \"2000\",\n    };\n\n    return (\n      <div className=\"context-menu\" style={myStyle}>\n        {items.map((item) => {\n          return (\n            <div\n              key={item.label}\n              className=\"context-menu-item\"\n              onClick={() => {\n                item.action();\n                this.handleClick();\n              }}\n            >\n              {\" \"}\n              <img src={item.icons} alt=\"\" width=\"30\" height=\"30\" /> {item.label}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  actionsList = [\n    {\n      label: \"Unselect\",\n      icons: \"icons/unselected.svg\",\n      action: () => this.eventsConnection.onUnselect.next(),\n    },\n    {\n      label: \"Isolate\",\n      icons: \"icons/isolate.svg\",\n      action: () => this.eventsConnection.onIsolateSelectedObjects.next(),\n    },\n    {\n      label: \"Hide\",\n      icons: \"icons/hide.svg\",\n      action: () => this.eventsConnection.onHideSelectedObjects.next(),\n    },\n    {\n      label: \"Show all\",\n      icons: \"icons/unisolate.svg\",\n      action: () => this.eventsConnection.onShowAll.next(),\n    },\n    {\n      label: \"Explode\",\n      icons: \"icons/explode.svg\",\n      action: () => this.eventsConnection.onExplode.next(),\n    },\n    {\n      label: \"Collect\",\n      icons: \"icons/collect.svg\",\n      action: () => this.eventsConnection.onCollect.next(),\n    },\n    {\n      label: \"Regeneration\",\n      icons: \"icons/regen.svg\",\n      action: () => this.eventsConnection.onRegeneration.next(),\n    },\n    {\n      label: \"Create preview\",\n      icons: \"icons/preview.svg\",\n      action: () => this.eventsConnection.onCreatePreview.next(),\n    },\n  ];\n\n  render() {\n    return (\n      <div onMouseEnter={this.mouseEnter} onMouseLeave={this.mouseLeave}>\n        {this.state.visible ? this.returnMenu(this.actionsList) : null}\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}